
# ThreadsApi

This is a php class to handle api requests to the Threads platform. You can use this class to perform various actions such as posting threads, comments, chat messages, deleting threads, messages, listing channels and uploading files.

## Authentication

You can create a new API key and find your existing keys at https://threads.com/apiKeys

When you create a new API key, we create a new Bot user for the key. The Bot user has the same posting privileges as any member in your organization.

All requests to the API must include this key as a bearer token in the Authorization header e.g. Authorization: Bearer <your_api_key>.

## Installation

To use this class, you need to have php installed on your system and a valid api key from Threads. You can get an api key by creating a bot user on Threads and copying the api key from the bot settings page.

To install this class, you can either download the ThreadsApi.php file and include it in your project, or use composer to install it as a dependency.

### Download

You can download the ThreadsApi.php file from this repository and save it in your project folder. Then you can include it in your php script using the require or include statement. For example:

```php
<?php
// Include the ThreadsApi class
require "ThreadsApi.php";

// Create an instance of the class with your api key
$threads = new ThreadsApi("<your_api_key>");

// Use the class methods to interact with the api
?>
```

### Composer

You can also use composer to install this class as a dependency in your project. To do that, you need to have composer installed on your system and create a composer.json file in your project folder. Then you can add this repository as a source and require the ThreadsApi class. For example:

```json
{
  "name": "your-project-name",
  "require": {
    "maaghaa/ThreadsApi": "*"
  },
  "repositories": [
    {
      "type": "vcs",
      "url": "https://github.com/maaghaa/ThreadsApi"
    }
  ]
}
```

Then you can run `composer install` to install the dependency. After that, you can include the autoload.php file generated by composer in your php script and use the ThreadsApi class. For example:

```php
<?php
// Include the autoload.php file
require "vendor/autoload.php";

// Create an instance of the class with your api key
$threads = new ThreadsApi("<your_api_key>");

// Use the class methods to interact with the api
?>
```

## Usage

To use this class, you need to create an instance of it with your api key as an argument. Then you can use the various methods of the class to perform different actions with the api. Here are some examples of how to use the class methods:

### Post a thread

To post a thread to a channel, you can use the `postThread` method. You need to provide either the channel name or the channel ID, and an array of blocks for the thread body. The blocks can be formatted using markdown. The method will return the response from the api as a string. For example:

```php
<?php
// Post a thread to a channel by name
$response = $threads->postThread("<your_channel_name>", null, array("# First Block", "Second block"));

// Post a thread to a channel by ID
$response = $threads->postThread(null, "<your_channel_id>", array("# First Block", "Second block"));

// Print the response
echo $response;
?>
```

### Post a comment

To post a comment to a thread, you can use the `postComment` method. You need to provide the thread ID and an array of blocks for the comment body. The blocks can be formatted using markdown. You can also optionally provide a parent ID if you want to reply to another comment or thread. The method will return the response from the api as a string. For example:

```php
<?php
// Post a comment to a thread by thread ID
$response = $threads->postComment("<your_thread_id>", array("# First Block", "Second block"), null);

// Post a comment to another comment or thread by parent ID
$response = $threads->postComment("<your_thread_id>", array("# First Block", "Second block"), "<your_comment_or_thread_id>");

// Print the response
echo $response;
?>
```

### Delete a thread

To delete a thread that the bot posted, you can use the `deleteThread` method. You need to provide the thread ID that you got from the `postThread` response or from the web URL of the thread. The method will return the response from the api as a string. For example:

```php
<?php
// Delete a thread by thread ID
$response = $threads->deleteThread("<your_thread_id>");

// Print the response
echo $response;
?>
```

### List your channels

To list the channels visible to your bot user, you can use the `channels` method. You don't need to provide any arguments for this method. The method will return the response from the api as a string. For example:

```php
<?php
// List your channels
$response = $threads->channels();

// Print the response
echo $response;
?>
```

### Post a chat message

To post a message to a chat, you can use the `postChatMessage` method. You need to provide either the chat name or the chat ID, and a string for the message body. The body can be formatted using markdown. The method will return the response from the api as a string. For example:

```php
<?php
// Post a chat message to a chat by name
$response = $threads->postChatMessage("<your_chat_name>", null, "# My Message");

// Post a chat message to a chat by ID
$response = $threads->postChatMessage(null, "<your_chat_id>", "# My Message");

// Print the response
echo $response;
?>
```

### Delete a chat message

To delete a message that the bot posted, you can use the `deleteChatMessage` method. You need to provide the message ID that you got from the `postChatMessage` response or from the web URL of the message. The method will return the response from the api as a string. For example:

```php
<?php
// Delete a chat message by message ID
$response = $threads->deleteChatMessage("<your_message_id>");

// Print the response
echo $response;
?>
```

### Upload a file

To upload a file that can be used in a subsequent `postThread` or `postChatMessage` request, you can use the `uploadFile` method. You need to provide the local location of the file as a string. Only uploading images and video mimetypes are allowed. The method will return the response from the api as a string. For example:

```php
<?php
// Upload a file by local location
$response = $threads->uploadFile("/path/to/your/file");

// Print the response
echo $response;
?>
```

## Markdown

We support some markdown for formatting your threads and chat messages. You can use the fileID from the `uploadFile` API to embedding an image or video file as a standalone block. Here are some examples of how to use markdown:

```php
<?php
// Post a thread with markdown formatting
$response = $threads->postThread("<your_channel_name>", null, array(
  "embedded link https://twitter.com",
  "[named twitter link](https://twitter.com)",
  "*bold text*",
  "/italic/",
  "_underline_",
  "-strikethrough-",
  "`inline code`",
  "* list item1 \n * list item2",
  "<@12345678901|> user mention using userID"
));

// Post a thread with an embedded file using fileID
$response = $threads->postThread("<your_channel_name>", null, array(
  "# My First Block",
  "embedded file below",
  "<!12345678901|>"
));

// Print the response
echo $response;
?>
```
